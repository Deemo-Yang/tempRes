webpackJsonp([23],{iub0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={data:function(){return{file1:[],file2:[],file3:[],file4:[],form:{id:0,companyid:"",patenttype:"",patentnumber:"",patentname:"",patentee:"",patentaddress:"",phone:"",patenteetype:"",technosphere:"",inventtype:"",applydate:"",impowerdate:"",auditdepartment:"",reportdate:"",status:0},rules:{patenttype:[{required:!0,message:"该项不能为空",trigger:"change"}],patentnumber:[{required:!0,message:"该项不能为空",trigger:"blur"}],patentname:[{required:!0,message:"该项不能为空",trigger:"blur"}],patentee:[{required:!0,message:"该项不能为空",trigger:"blur"}],patentaddress:[{required:!0,message:"该项不能为空",trigger:"blur"}],phone:[{required:!0,message:"该项不能为空",trigger:"blur"},{type:"number",message:"请填写电话号码"}],patenteetype:[{required:!0,message:"该项不能为空",trigger:"change"}],technosphere:[{required:!0,message:"该项不能为空",trigger:"blur"}],inventtype:[{required:!0,message:"该项不能为空",trigger:"blur"}],applydate:[{required:!0,message:"该项不能为空",trigger:"change"}],impowerdate:[{required:!0,message:"该项不能为空",trigger:"change"}],auditdepartment:[{required:!0,message:"该项不能为空",trigger:"change"}]}}},created:function(){this.getdata()},methods:{onSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=!1,l=!1,r=!1,o=!1;e.$api.get("api/Intellectualpropertyallowancestorages?filter="+encodeURI('{"where":{"and":[{"intellectualpropertyallowanceid":'+e.form.id+"}]}}"),null,function(t){if(0!==t.length){for(var i in t)switch(t[i].type){case"file1":a=!0;break;case"file2":l=!0;break;case"file3":r=!0;break;case"file4":o=!0;break;default:console.log("什么也不是")}a&&l&&r&&o?(e.form.status=1,console.log(e.form.status),e.$api.patch("api/Intellectualpropertyallowances",e.form,function(t){e.$router.push("/pstable"),e.$alert("提交成功","提示",{confirmButtonText:"确定",type:"success"})})):e.$alert("文件未上传","提示",{confirmButtonText:"确定",type:"error"})}else e.$alert("文件未上传","提示",{confirmButtonText:"确定",type:"error"})})}else e.$alert("表单未全部填写完成","提示",{confirmButtonText:"确定",type:"error"})})},save:function(){var e=this;this.$api.patch("api/Intellectualpropertyallowances",this.form,function(t){e.form.id=t.id,e.$message.success("保存成功")})},getdata:function(){var e=this;this.form.companyid=localStorage.getItem("companyid"),this.form.reportdate=this.getdate(),this.$route.query.proid&&(this.$api.get("api/Intellectualpropertyallowancestorages?filter="+encodeURI('{"where":{"and":[{"intellectualpropertyallowanceid":'+this.$route.query.proid+"}]}}"),null,function(t){if(0!==t.length)for(var a in t)switch(t[a].type){case"file1":e.file1=[{name:t[a].name.slice(14),url:t[a].url}];break;case"file2":e.file2=[{name:t[a].name.slice(14),url:t[a].url}];break;case"file3":e.file3=[{name:t[a].name.slice(14),url:t[a].url}];break;case"file4":e.file4=[{name:t[a].name.slice(14),url:t[a].url}];break;default:console.log("什么也不是")}}),this.$api.get("api/Intellectualpropertyallowances/"+this.$route.query.proid,null,function(t){e.form=t}))},getdate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,l=e.getDate();return a>=1&&a<=9&&(a="0"+a),l>=0&&l<=9&&(l="0"+l),t+"-"+a+"-"+l},pagejump:function(){this.$router.push("/pstable")},beforeupload:function(){if(0===this.form.id)return this.$alert("请先保存再上传文件","提示",{confirmButtonText:"确定",type:"error"}),!1},uploadsuccess1:function(e,t,a){var l=this;this.$api.post("api/Intellectualpropertyallowancestorages",{id:0,name:e[0].name,url:e[0].url,type:"file1",intellectualpropertyallowanceid:this.form.id},function(e){l.file1=[{name:e.name.slice(14),url:e.url}]})},uploadsuccess2:function(e,t,a){var l=this;this.$api.post("api/Intellectualpropertyallowancestorages",{id:0,name:e[0].name,url:e[0].url,type:"file2",intellectualpropertyallowanceid:this.form.id},function(e){l.file2=[{name:e.name.slice(14),url:e.url}]})},uploadsuccess3:function(e,t,a){var l=this;this.$api.post("api/Intellectualpropertyallowancestorages",{id:0,name:e[0].name,url:e[0].url,type:"file3",intellectualpropertyallowanceid:this.form.id},function(e){l.file3=[{name:e.name.slice(14),url:e.url}]})},uploadsuccess4:function(e,t,a){var l=this;this.$api.post("api/Intellectualpropertyallowancestorages",{id:0,name:e[0].name,url:e[0].url,type:"file4",intellectualpropertyallowanceid:this.form.id},function(e){l.file3=[{name:e.name.slice(14),url:e.url}]})},fileremove:function(e){var t=this;this.$api.get("api/Intellectualpropertyallowancestorages?filter="+encodeURI('{"where":{"url":{"like":"%'+e.url+'%"}}}'),null,function(e){0!==e.length?(t.$api.delete("api/Intellectualpropertyallowancestorages/"+e[0].id,null,function(e){}),t.$message.success("删除成功")):t.$alert("文件未上传成功，文件不存在，删除错误","提示",{confirmButtonText:"确定"})})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._m(0),e._v(" "),a("div",{staticClass:"container"},[a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:e.pagejump}},[e._v("草稿箱")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.form,mar:"","label-width":"120px","label-position":"left",rules:e.rules}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{md:12,offset:6}},[a("el-form-item",{attrs:{label:"国内或国外专利",prop:"patenttype"}},[a("el-radio",{attrs:{label:"国内专利"},model:{value:e.form.patenttype,callback:function(t){e.$set(e.form,"patenttype",t)},expression:"form.patenttype"}}),e._v(" "),a("el-radio",{attrs:{label:"国外专利"},model:{value:e.form.patenttype,callback:function(t){e.$set(e.form,"patenttype",t)},expression:"form.patenttype"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"专利号",prop:"patentnumber"}},[a("el-input",{attrs:{type:"text",required:"true"},model:{value:e.form.patentnumber,callback:function(t){e.$set(e.form,"patentnumber",t)},expression:"form.patentnumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"专利名称",prop:"patentname"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.patentname,callback:function(t){e.$set(e.form,"patentname",t)},expression:"form.patentname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"专利权人",prop:"patentee"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.patentee,callback:function(t){e.$set(e.form,"patentee",t)},expression:"form.patentee"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"专利权人地址",prop:"patentaddress"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.patentaddress,callback:function(t){e.$set(e.form,"patentaddress",t)},expression:"form.patentaddress"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",e._n(t))},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"专利权人类型",prop:"patenteetype"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.patenteetype,callback:function(t){e.$set(e.form,"patenteetype",t)},expression:"form.patenteetype"}},[a("el-option",{attrs:{label:"个人",value:"个人"}}),e._v(" "),a("el-option",{attrs:{label:"企业",value:"企业"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"技术领域",prop:"technosphere"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.technosphere,callback:function(t){e.$set(e.form,"technosphere",t)},expression:"form.technosphere"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发明类型",prop:"inventtype"}},[a("el-input",{attrs:{type:"text"},model:{value:e.form.inventtype,callback:function(t){e.$set(e.form,"inventtype",t)},expression:"form.inventtype"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请日",prop:"applydate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.form.applydate,callback:function(t){e.$set(e.form,"applydate",t)},expression:"form.applydate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"授权公告日",prop:"impowerdate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.form.impowerdate,callback:function(t){e.$set(e.form,"impowerdate",t)},expression:"form.impowerdate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审核单位",prop:"auditdepartment"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.auditdepartment,callback:function(t){e.$set(e.form,"auditdepartment",t)},expression:"form.auditdepartment"}},[a("el-option",{attrs:{label:"度假区中小企业服务中心",value:"度假区中小企业服务中心"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"http://132.232.140.241:3000/api/StorageFiles/upload","show-file-list":!0,"on-success":e.uploadsuccess1,"on-remove":e.fileremove,"before-upload":e.beforeupload,"file-list":e.file1,limit:1,"list-type":"picture-card"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取材料文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("专利证书首页,不超过1MB")])],1),a("br")],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"http://132.232.140.241:3000/api/StorageFiles/upload","show-file-list":!0,"on-success":e.uploadsuccess2,"on-remove":e.fileremove,"before-upload":e.beforeupload,"file-list":e.file2,limit:1,"list-type":"picture-card"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取材料文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("专利证书扉页,不超过1MB")])],1),a("br")],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"http://132.232.140.241:3000/api/StorageFiles/upload","show-file-list":!0,"on-success":e.uploadsuccess3,"on-remove":e.fileremove,"before-upload":e.beforeupload,"file-list":e.file3,limit:1,"list-type":"picture-card"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取材料文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("专利权人身份证,不超过1MB")])],1),a("br")],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"http://132.232.140.241:3000/api/StorageFiles/upload","show-file-list":!0,"on-success":e.uploadsuccess4,"on-remove":e.fileremove,"before-upload":e.beforeupload,"file-list":e.file4,limit:1,"list-type":"picture-card"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取材料文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("专利资助授权委托书,不超过1MB")])],1),a("br")],1)],1),a("br"),e._v(" "),a("div",{attrs:{align:"center"}},[a("el-button",{on:{click:e.save}},[e._v("保存")])],1)],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"crumbs"},[t("span",[this._v("知识产权补助")])])}]},o=a("VU/8")(l,r,!1,null,null,null);t.default=o.exports}});